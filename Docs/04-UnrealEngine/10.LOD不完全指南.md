# LOD不完全指南

电子计算机的发明起源于第二次世界大战期间，当时火炮和弹道计算变得日益复杂，原有的计算工具已经无法满足需求，为了解决这些问题，科学家和工程师们开始研制电子计算机。

无论什么时代，都挡不住人们对美好事物的追求，伴随着电子计算机的出现，电子游戏也应运而生。

在电子游戏的发展进程中，总有那么一些脑洞大开的创意和技术，它不断地突破硬件开发者思维的设限，极致地压榨硬件的性能，驱动着计算机向着一个惊人的方向发展：

- [知乎 | 电子游戏的前世，今生和未来 - 麦片](https://zhuanlan.zhihu.com/p/206828303)

而 **LOD（Level of Detail ）**，正是在这个发展过程中出现并一直延用至今的一项技术，它旨在：

- 在不同 **重要性（Significance）** 的场合，采用不同精度的策略，从而尽可能的减少资源的浪费，提升整个系统的上限。

这样的思想策略体现在游戏制作的方方面面

## 模型

在模型上， LOD 的应用主要是为模型创建多个精度级别的底模，在近距离时，使用高精度模型，远距离时，使用低精度模型。

在用于实时渲染领域且具有一定规模的三维场景中，为了保证程序的帧率，模型LOD的制作通常是开发团队无法绕开的难题。

高额的时间和人力成本让很多独立开发者和小型团队搭建复杂场景时需要面临非常多非常多的困难。

直到UE的虚拟几何体技术—— **Nanite** ，横空出世，从而大幅度降低了场景制作的门槛。

Nanite 会分析模型几何的重要性信息，自动生成高质量的LOD，不仅占用了更少的存储空间，还可以以非常高的性能绘制，它无疑是几何渲染的未来。

但目前而言，在一些特定场景下，我们还不能完全放弃LOD：

- 现代PC的GPU算力通常是冗余的，大部分的中端GPU足以应付一些常见的复杂场景渲染，但其他平台，如移动设备，X Box，Switch...，对于有较高画面要求的项目，它们的算力目前而言更多只是堪堪够用，为了追求更好的视觉效果，甚至往往需要定制一些比较Hack的渲染机制来进行极致的优化，而所分配剩余的算力很难支撑起Nanite的运作。
- Nanite的模型简化算法在一些特殊的模型类型上还有很大的优化空间，比如植被，如果是植被密度较大范围较广的复杂场景，使用LOD能更大程度地压缩性能，这在之前的[文章](https://zhuanlan.zhihu.com/p/713731229)中有提到。

### 谁来制作？

之期大部分的游戏项目，通常是由美术人员在DDC软件中来制作LOD，美术人员在提供模型源文件的同时，按照一定规范来生产模型对应的LOD。

这种做法，目前来看是存在一定局限性的：

- 早期的模型制作流程比较“务实”，大部分时候还是只能通过人工建模的方式，而现在涌现了许多网格处理的SDK，它们往往会提供一些有效的模型简化算法，无需重新建模，就能生成高品质的LOD。 
- 人工制作LOD往往需要高额的成本，团队自身有足够的人力物力还好，如果是交给外包团队去做这个事情的话，无疑会是一笔巨大的开销。
- 任何方法论都有一定适用条件，模型制作也一样，除了一些老牌制作厂商之外，大部分团队应该都很难在游戏制作之初，就能制定出一套尽善尽美的制作规范，往往很多隐秘的问题随着开发进度的推进逐渐浮现，而美术制作又是整个项目中费用消耗的大头，对于LOD制作来说，如果源模型或者规范变了，那么之前制作的“产品”就白费了，所以我们需要将关注点从制作具体的 LOD ，转化为去搭建一条可迭代的 LOD 生产管线。
- 源模型虽然是由美术人员制作的，但他们往往对性能并不敏感，对LOD的认识也不是很深，在面对那些无论怎么制作都很难满足规范的模型时，他们所表现出来的，只会是无措。

此时如果有人对几何处理，图形渲染，编辑器方向有深入的了解，以程序化的方式包揽这些事务，就可以为团队节省出大量的制作成本，这类专业人员一般被定义为 **管线TA** / **引擎管线工程师**。

### 如何制作？

在阐述LOD制作之前，我们先了解一下一些现代游戏中的模型制作规格：

- [一些次世代游戏中的三角形计数 | Polycount](https://polycount.com/discussion/141061/polycounts-in-next-gen-games-thread)
- [一些视频游戏中的三角形计数 | Polycount](https://polycount.com/discussion/126662/triangle-counts-for-assets-from-various-videogames)

这些资料可以作为有效的参考，避免源模型就出现那种超出实时渲染规格的情况，这是 [3D - ACE](https://3d-ace.com/) 给出的一个标准：

- **PC 和游戏机**

  | **游戏资产**   | **多边形计数 （UE）** | **三角形数 （UE）** | **多边形计数 （Unity）** | **三角形计数 （Unity）** |
  | -------------- | --------------------- | ------------------- | ------------------------ | ------------------------ |
  | **低细节角色** | 10,000-20,000         | 20,000-40,000       | 5,000-10,000             | 10,000-20,000            |
  | **高细节角色** | 20,000-60,000         | 40,000-120,000      | 10,000-30,000            | 20,000-60,000            |
  | **简单道具**   | 500-2,000             | 1,000-4,000         | 250-1,000                | 500-2,000                |
  | **复杂道具**   | 2,000-10,000          | 4,000-20,000        | 1,000-5,000              | 2,000-10,000             |
  | **基本环境**   | 10,000-50,000         | 20,000-100,000      | 5,000-25,000             | 10,000-50,000            |
  | **详细环境**   | 50,000-200,000        | 100,000-400,000     | 25,000-100,000           | 50,000-200,000           |

- **移动和低端设备**

  | **游戏资产**   | **多边形计数** | **三角形计数** |
  | -------------- | -------------- | -------------- |
  | **低细节角色** | 1,000-5,000    | 2,000-10,000   |
  | **高细节角色** | 5,000-10,000   | 10,000-20,000  |
  | **简单道具**   | 100-500        | 200-1,000      |
  | **复杂道具**   | 500-2,000      | 1,000-4,000    |
  | **基本环境**   | 2,000-10,000   | 4,000-20,000   |
  | **详细环境**   | 10,000-20,000  | 20,000-40,000  |

- **VR/AR 设备**

  | **游戏资产**   | **多边形计数** | **三角形计数** |
  | -------------- | -------------- | -------------- |
  | **低细节角色** | 2,000-10,000   | 4,000-20,000   |
  | **高细节角色** | 10,000-20,000  | 20,000-40,000  |
  | **简单道具**   | 500-1,500      | 1,000-3,000    |
  | **复杂道具**   | 1,500-5,000    | 3,000-10,000   |
  | **基本环境**   | 5,000-15,000   | 10,000-30,000  |
  | **详细环境**   | 15,000-30,000  | 30,000-60,000  |

原博客位于：

- [多边形数量在游戏资产的 3D 建模中重要吗？– 3D-Ace 工作室](https://3d-ace.com/blog/polygon-count-in-3d-modeling-for-game-assets/)

3D-ACE中有很多有价值的 [博客](https://3d-ace.com/blog/) 参考，感兴趣的小伙伴可以看下：

![image-20241023201143597](Resources/image-20241023201143597.png)

在制作LOD之前，我们最好搭建一个简单的预览关卡，通过一个简单的编辑器工具来自动排列

- 根据资产列表或者资产路径确定要预览的所有资产。
- 根据模型的包围球半径作为间隔进行横向排布。
- 将LOD的屏幕尺寸转化为距离，纵向排布所有LOD。
- 在生成的模型上扩展显示一些关键信息，比如屏幕尺寸，距离，顶点数，面数...





在预览关卡中我们能更加直观地查看和管理模型的规格

[多边形数量在游戏资产的 3D 建模中重要吗？– 3D-Ace 工作室](https://3d-ace.com/blog/polygon-count-in-3d-modeling-for-game-assets/)

[当涉及到 LOD 过渡时要考虑什么？ - Simplygon 博客](https://www.simplygon.com/posts/51aba9d5-bafd-459d-94b8-718273fdf092)

[Polycounts in next gen games thread! — polycount](https://polycount.com/discussion/141061/polycounts-in-next-gen-games-thread)

[Triangle counts for assets from various videogames — polycount](https://polycount.com/discussion/126662/triangle-counts-for-assets-from-various-videogames)

## 贴图

在贴图上，LOD的应用主要是为贴图生成Mipmap

## 地形

## 特效

## 阴影

## 动作



## Why？

## Who？

## How？

### Look Dev

### 距离 VS 屏幕尺寸

### Pipeline

### Transition

## HLOD

